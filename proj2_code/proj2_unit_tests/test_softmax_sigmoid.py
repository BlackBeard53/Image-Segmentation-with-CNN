import sys
import os
sys.path.append(os.getcwd())
import student_code as student_code
import torch

def test_sigmoid():
    
    x = torch.tensor([-1.5243,  0.6346,  0.2938, -0.1627, -1.2101,  1.1302,  0.4210,  0.6112, 0.6843,  1.7647])
    y_true = torch.tensor([0.17882919311523437500, 0.65353173017501831055, 0.57292616367340087891, 0.45941448211669921875, 0.22968336939811706543, 0.75587576627731323242,0.60372251272201538086, 0.64821445941925048828, 0.66469776630401611328,0.85379731655120849609])
    y_student = student_code.sigmoid(x)
    
    assert torch.allclose(y_true, y_student) == True

def test_softmax():
    
    x = torch.tensor([-1.5243,  0.6346,  0.2938, -0.1627, -1.2101,  1.1302,  0.4210,  0.6112, 0.6843,  1.7647])
    y_true = torch.tensor([0.01153572555631399155, 0.09991788864135742188, 0.07106171548366546631, 0.04501738771796226501, 0.01579429209232330322, 0.16401350498199462891, 0.08070081472396850586, 0.09760695695877075195, 0.10500928759574890137, 0.30934241414070129395])
    y_student = student_code.softmax(x)
    
    assert torch.allclose(y_true, y_student) == True

    